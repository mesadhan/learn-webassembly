<h1>Hello! From Webassembly</h1>
<pre id="setResult">

</pre>

<script>

    // Read data from webassembly memory ArrayBuffer
    const readMemoryStringFromBuffer = (offset, length) => {
        let memoryBuffer = wasm.instance.exports.memory.buffer;

        const strBuffer = new Uint8Array(memoryBuffer, offset, length);
        const string = new TextDecoder().decode(strBuffer);

        // Make notify and make use of that string throw event
        window.dispatchEvent(new CustomEvent('wasmValue', {detail: string}));
    };
    window.addEventListener('wasmValue', result => {
       console.log('Receive String From C:- ', result.detail);
    });

    const imports = {
        env: {
            numberLog: console.log,
            stringLog: readMemoryStringFromBuffer
        }
    };

    WebAssembly.instantiateStreaming(fetch('program.wasm'), imports).then(results => {

        // make it global
        window.wasm = results;

        console.log('WASM Loaded................');


        console.log('All Import Methods:- ', WebAssembly.Module.imports(results.module));
        results.instance.exports.getNumber(33);
        results.instance.exports.messageLog();
    });

</script>
